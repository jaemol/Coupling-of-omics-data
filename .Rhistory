normMethod = "none",
zeroMethod = "none",
sparsMethod = "threshold",
dissFunc = "signed",
verbose = 3,
seed = 123456)
props_single <- netAnalyze(net_single,
centrLCC = TRUE,
clustMethod = "cluster_fast_greedy",
hubPar = "eigenvector",
weightDeg = FALSE, normDeg = FALSE)
plot(props_single, labelScale = F, cexLabels = 1)
inData
gsub("DATA.Bacteria_[A-Zaz]*_[A-Zaz]*_[A-Zaz]*_[A-Zaz]*_(.*)","\\1",colnames(inData))
gsub("DATA.Bacteria_[A-Za-z]*_[A-Za-z]*_[A-Za-z]*_[A-Za-z]*_(.*)","\\1",colnames(inData))
gsub("DATA.[A-Za-z]*_[A-Za-z]*_[A-Za-z]*_[A-Za-z]*_[A-Za-z]*_(.*)","\\1",colnames(inData))
colnames(inData)=gsub("DATA.Bacteria_[A-Za-z]*_[A-Za-z]*_[A-Za-z]*_[A-Za-z]*_(.*)","\\1",colnames(inData))
# building single network with SPRING as association measure
net_single <- netConstruct(inData,
#filtTax = "highestFreq",
#filtTaxPar = list(highestFreq = 100),
#filtSamp = "totalReads",
#filtSampPar = list(totalReads = 1000),
measure = "spearman",thresh = 0.6,
measurePar = list(nlambda=10,
rep.num=10),
normMethod = "none",
zeroMethod = "none",
sparsMethod = "threshold",
dissFunc = "signed",
verbose = 3,
seed = 123456)
props_single <- netAnalyze(net_single,
centrLCC = TRUE,
clustMethod = "cluster_fast_greedy",
hubPar = "eigenvector",
weightDeg = FALSE, normDeg = FALSE)
plot(props_single, labelScale = F, cexLabels = 1, )
plot(inData$TolC1, inData$Escherichia.Shigella)
cor(inData$TolC1, inData$Escherichia.Shigella)
cor(inData$TolC1, inData$Escherichia.Shigella)^2
cor(inData$TolC1, inData$Escherichia.Shigella, method = "spear")
# loading NetCoMi library
library(NetCoMi)
# building single network with SPRING as association measure
net_single <- netConstruct(inData,
#filtTax = "highestFreq",
#filtTaxPar = list(highestFreq = 100),
#filtSamp = "totalReads",
#filtSampPar = list(totalReads = 1000),
measure = "spearman",thresh = 0.6,
measurePar = list(nlambda=10,
rep.num=10),
normMethod = "none",
zeroMethod = "none",
sparsMethod = "threshold",
dissFunc = "signed",
verbose = 3,
seed = 123456)
props_single <- netAnalyze(net_single,
centrLCC = TRUE,
clustMethod = "cluster_fast_greedy",
hubPar = "eigenvector",
weightDeg = FALSE, normDeg = FALSE)
plot(props_single, labelScale = F, cexLabels = 1 )
cor(inData$TolC1, inData$Escherichia.Shigella, method = "spear")
?cor
net_single
plot(props_single,
labelScale = F,
cexLabels = 1,
title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 2.3,
nodeColor = "cluster",
nodeSize = "eigenvector",
nodeShape = "circle")
plot(props_single,
labelScale = F,
cexLabels = 1,
title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 2.3,
nodeColor = "cluster",
nodeSize = "eigenvector"
)
cexTitle = 2.3
legend(0.7, 1.1, cex = 2.2, title = "estimated correlation:",
legend = c("+","-"), lty = 1, lwd = 3, col = c("#009900","red"),
bty = "n", horiz = TRUE)
plot(props_single,
legend(0.7, 1.1, cex = 2.2, title = "estimated correlation:",
legend = c("+","-"), lty = 1, lwd = 3, col = c("#009900","red"),
bty = "n", horiz = TRUE)
plot(props_single,
plot(props_single,
labelScale = F,
cexLabels = 1,
title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 2.3)
plot(props_single,
labelScale = F,
cexLabels = 1,
title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 2.3)
legend(0.7, 1.1, cex = 2.2, title = "estimated correlation:",
legend = c("+","-"), lty = 1, lwd = 3, col = c("#009900","red"),
bty = "n", horiz = TRUE)
legend(cex = 2.2, title = "estimated correlation:",
legend = c("+","-"), lty = 1, lwd = 3, col = c("#009900","red"),
bty = "n", horiz = TRUE)
legend(0.1, 0.5, cex = 1.1, title = "estimated correlation:",
legend = c("+","-"), lty = 1, lwd = 3, col = c("#009900","red"),
bty = "n", horiz = TRUE)
legend(0.1, 1.5, cex = 1.1, title = "estimated correlation:",
legend = c("+","-"), lty = 1, lwd = 3, col = c("#009900","red"),
bty = "n", horiz = TRUE)
legend(0.1, 2.5, cex = 1.1, title = "estimated correlation:",
legend = c("+","-"), lty = 1, lwd = 3, col = c("#009900","red"),
bty = "n", horiz = TRUE)
legend(0.1, 2.5, cex = 1.1, title = "estimated correlation:",
legend = c("+","-"), lty = 1, lwd = 3, col = c("#009900","red"),
bty = "n", horiz = TRUE, location = "northeast")
?legend
legend(0.4, 2.5, cex = 1.1, title = "estimated correlation:",
legend = c("+","-"), lty = 1, lwd = 3, col = c("#009900","red"),
bty = "n", horiz = TRUE)
legend("topright", cex = 1.1, title = "estimated correlation:",
legend = c("+","-"), lty = 1, lwd = 3, col = c("#009900","red"),
bty = "n", horiz = TRUE)
plot(props_single,
labelScale = F,
cexLabels = 1,
title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 2.3)
legend("topright", cex = 1.1, title = "estimated correlation:",
legend = c("+","-"), lty = 1, lwd = 3, col = c("#009900","red"),
bty = "n", horiz = TRUE)
legend("topright", cex = 0.5, title = "estimated correlation:",
legend = c("+","-"), lty = 1, lwd = 3, col = c("#009900","red"),
bty = "n", horiz = TRUE)
plot(props_single,
labelScale = F,
cexLabels = 1,
title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 2.3)
#nodeColor = "cluster",
#nodeSize = "eigenvector")
legend("topright", cex = 0.5, title = "estimated correlation:",
legend = c("+","-"), lty = 1, lwd = 3, col = c("#009900","red"),
bty = "n", horiz = TRUE)
legend("topright", cex = 1, title = "estimated correlation:",
legend = c("+","-"), lty = 1, lwd = 3, col = c("#009900","red"),
bty = "n", horiz = TRUE)
legend("middleright", cex = 1, title = "estimated correlation:",
legend = c("+","-"), lty = 1, lwd = 3, col = c("#009900","red"),
bty = "n", horiz = TRUE)
legend("right", cex = 1, title = "estimated correlation:",
legend = c("+","-"), lty = 1, lwd = 3, col = c("#009900","red"),
bty = "n", horiz = TRUE)
legend("topleft", cex = 1, title = "estimated correlation:",
legend = c("+","-"), lty = 1, lwd = 3, col = c("#009900","red"),
bty = "n", horiz = TRUE)
legend("topleft", cex = 0.8, title = "estimated correlation:",
legend = c("+","-"), lty = 1, lwd = 3, col = c("#009900","red"),
bty = "n", horiz = TRUE)
legend("topleft", cex = 3, title = "estimated correlation:",
legend = c("+","-"), lty = 1, lwd = 3, col = c("#009900","red"),
bty = "n", horiz = TRUE)
plot(props_single,
labelScale = F,
cexLabels = 1,
title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 2.3)
plot(props_single,
labelScale = F,
cexLabels = 1,
title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 2.3,
nodeColor = "feature")
plot(props_single,
labelScale = F,
cexLabels = 1,
title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 2.3,
nodeColor = "cluster")
plot(props_single,
labelScale = T,
cexLabels = 1,
title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 2.3,
nodeColor = "cluster")
plot(props_single,
labelScale = F,
cexLabels = 1,
title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 2.3,
nodeColor = "cluster")
plot(props_single,
labelScale = F,
cexLabels = 1.3,
title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 2.3,
nodeColor = "cluster")
colnames(inData)
colnames(inData)=gsub("DATA.Bacteria_[A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.](.*)","\\1",colnames(inData))
colnames(inData)
colnames(inData)=gsub("DATA.Archaea_[A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.](.*)","\\1",colnames(inData))
colnames(inData)
# building single network with SPRING as association measure
net_single <- netConstruct(inData,
#filtTax = "highestFreq",
#filtTaxPar = list(highestFreq = 100),
#filtSamp = "totalReads",
#filtSampPar = list(totalReads = 1000),
measure = "spearman",thresh = 0.6,
measurePar = list(nlambda=10,
rep.num=10),
normMethod = "none",
zeroMethod = "none",
sparsMethod = "threshold",
dissFunc = "signed",
verbose = 3,
seed = 123456)
props_single <- netAnalyze(net_single,
centrLCC = TRUE,
clustMethod = "cluster_fast_greedy",
hubPar = "eigenvector",
weightDeg = FALSE, normDeg = FALSE)
plot(props_single,
labelScale = F,
cexLabels = 1.3,
title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 2.3,
nodeColor = "cluster")
inData$Campylobacter
?rep
colVector <- 1:length(colnames(inData))
for (i in 1:length(colVector)) {
if (i<43) {colVector[i] = "green"} else {colVector[i] = "red"}
}
plot(props_single,
labelScale = F,
cexLabels = 1.3,
title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 2.3,
nodeColor = colVector)
# loading data
chosenWeek <- "Week 02"
inData <- extracting_data_KAT(whichWeek = chosenWeek)
# filtering data
inData <- data_filtering(inData)
# excluding testID and OUA (antibiotics used or not)
#inData = data
testID  <- inData$testID
OUA     <- inData$OUA
inData = subset(inData, select = -c(testID, OUA))
which(colnames(inData)=="Data.*")
which(grep(colnames(inData), pattern = "DATA.*"))
which(grep(x = colnames(inData), pattern = "DATA.*"))
grep(colnames(inData))
grep(x = colnames(inData))
grep(x = colnames(inData), pattern = "DATA.*")
dataTwoColumns <- max(dataOneColumns):length(inData[,1])
dataOneColumns <- grep(x = colnames(inData), pattern = "DATA.*")
dataTwoColumns <- max(dataOneColumns):length(inData[,1])
dataTwoColumns
dataTwoColumns <- max(dataOneColumns)+1:length(inData[,1])
dataTwoColumns
colVector <- 1:length(colnames(inData))
for (i in 1:length(colVector)) {
if (i<=max(dataOneColumns)) {colVector[i] = "green"} else {colVector[i] = "red"}
}
colnames(inData)=gsub("DATA.Bacteria_[A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.](.*)","\\1",colnames(inData))
colnames(inData)=gsub("DATA.Archaea_[A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.](.*)","\\1",colnames(inData))
# building single network with SPRING as association measure
net_single <- netConstruct(inData,
#filtTax = "highestFreq",
#filtTaxPar = list(highestFreq = 100),
#filtSamp = "totalReads",
#filtSampPar = list(totalReads = 1000),
measure = "spearman",thresh = 0.6,
measurePar = list(nlambda=10,
rep.num=10),
normMethod = "none",
zeroMethod = "none",
sparsMethod = "threshold",
dissFunc = "signed",
verbose = 3,
seed = 123456)
props_single <- netAnalyze(net_single,
centrLCC = TRUE,
clustMethod = "cluster_fast_greedy",
hubPar = "eigenvector",
weightDeg = FALSE, normDeg = FALSE)
plot(props_single,
labelScale = F,
cexLabels = 1.3,
title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 2.3,
nodeColor = colVector)
plot(props_single,
labelScale = F,
cexLabels = 1.3,
title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 2.3,
colorVec = colVector)
colVector
plot(props_single,
labelScale = F,
cexLabels = 1.3,
title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 2.3,
nodeColor = colVector)
# building single network with SPRING as association measure
net_single_fullSet <- netConstruct(inData,
#filtTax = "highestFreq",
#filtTaxPar = list(highestFreq = 100),
#filtSamp = "totalReads",
#filtSampPar = list(totalReads = 1000),
measure = "spearman",thresh = 0.6,
measurePar = list(nlambda=10,
rep.num=10),
normMethod = "none",
zeroMethod = "none",
sparsMethod = "threshold",
dissFunc = "signed",
verbose = 3,
seed = 123456)
props_single_fullSet <- netAnalyze(net_single_fullSet,
centrLCC = TRUE,
clustMethod = "cluster_fast_greedy",
hubPar = "eigenvector",
weightDeg = FALSE, normDeg = FALSE)
plot(props_single_fullSet,
labelScale = F,
cexLabels = 1.3,
title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 2.3,
nodeColor = colVector)
data_untreated <- inData[OUA==0]
which(OUA==0)
which(OUA==1)
data_untreated <- inData[which(OUA==0),]
data_untreated
length(which(OUA==0))
# loading data
chosenWeek <- "Week 02"
inData <- extracting_data_KAT(whichWeek = chosenWeek)
# filtering data
inData <- data_filtering(inData)
# excluding testID and OUA (antibiotics used or not)
#inData = data
testID  <- inData$testID
OUA     <- inData$OUA
data = subset(inData, select = -c(testID, OUA))
dataOneColumns <- grep(x = colnames(data), pattern = "DATA.*")
colVector <- 1:length(colnames(data))
for (i in 1:length(colVector)) {
if (i<=max(dataOneColumns)) {colVector[i] = "green"} else {colVector[i] = "red"}
}
colnames(data)=gsub("DATA.Bacteria_[A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.](.*)","\\1",colnames(data))
colnames(data)=gsub("DATA.Archaea_[A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.](.*)","\\1",colnames(data))
# building single network with SPRING as association measure - Full dataset, both treated and untreated
net_single_fullSet <- netConstruct(data,
#filtTax = "highestFreq",
#filtTaxPar = list(highestFreq = 100),
#filtSamp = "totalReads",
#filtSampPar = list(totalReads = 1000),
measure = "spearman",thresh = 0.6,
measurePar = list(nlambda=10,
rep.num=10),
normMethod = "none",
zeroMethod = "none",
sparsMethod = "threshold",
dissFunc = "signed",
verbose = 3,
seed = 123456)
props_single_fullSet <- netAnalyze(net_single_fullSet,
centrLCC = TRUE,
clustMethod = "cluster_fast_greedy",
hubPar = "eigenvector",
weightDeg = FALSE, normDeg = FALSE)
plot(props_single_fullSet,
labelScale = F,
cexLabels = 1.3,
title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 2.3,
nodeColor = colVector)
# network untreated, single network with spearman association
data_untreated <- data[which(OUA==0),]
net_single_untreated <- netConstruct(data_untreated,
#filtTax = "highestFreq",
#filtTaxPar = list(highestFreq = 100),
#filtSamp = "totalReads",
#filtSampPar = list(totalReads = 1000),
measure = "spearman",thresh = 0.6,
measurePar = list(nlambda=10,
rep.num=10),
normMethod = "none",
zeroMethod = "none",
sparsMethod = "threshold",
dissFunc = "signed",
verbose = 3,
seed = 123456)
props_single_untreated <- netAnalyze(net_single_untreated,
centrLCC = TRUE,
clustMethod = "cluster_fast_greedy",
hubPar = "eigenvector",
weightDeg = FALSE, normDeg = FALSE)
plot(props_single_untreated,
labelScale = F,
cexLabels = 1.3,
title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 2.3,
nodeColor = colVector)
plot(props_single_untreated,
labelScale = F,
cexLabels = 1.3,
title1 = "Single network with Spearman, untreated",
showTitle = T,
cexTitle = 2.3,
nodeColor = colVector)
# network treated, single network with spearman association
data_treated <- data[which(OUA==1),]
net_single_treated <- netConstruct(data_treated,
#filtTax = "highestFreq",
#filtTaxPar = list(highestFreq = 100),
#filtSamp = "totalReads",
#filtSampPar = list(totalReads = 1000),
measure = "spearman",thresh = 0.6,
measurePar = list(nlambda=10,
rep.num=10),
normMethod = "none",
zeroMethod = "none",
sparsMethod = "threshold",
dissFunc = "signed",
verbose = 3,
seed = 123456)
props_single_treated <- netAnalyze(net_single_treated,
centrLCC = TRUE,
clustMethod = "cluster_fast_greedy",
hubPar = "eigenvector",
weightDeg = FALSE, normDeg = FALSE)
plot(props_single_treated,
labelScale = F,
cexLabels = 1.3,
title1 = "Single network with Spearman, treated",
showTitle = T,
cexTitle = 2.3,
nodeColor = colVector)
net_single_treated <- netConstruct(data_treated,
#filtTax = "highestFreq",
#filtTaxPar = list(highestFreq = 100),
#filtSamp = "totalReads",
#filtSampPar = list(totalReads = 1000),
measure = "spearman",thresh = 0.5,
measurePar = list(nlambda=10,
rep.num=10),
normMethod = "none",
zeroMethod = "none",
sparsMethod = "threshold",
dissFunc = "signed",
verbose = 3,
seed = 123456)
props_single_treated <- netAnalyze(net_single_treated,
centrLCC = TRUE,
clustMethod = "cluster_fast_greedy",
hubPar = "eigenvector",
weightDeg = FALSE, normDeg = FALSE)
plot(props_single_treated,
labelScale = F,
cexLabels = 1.3,
title1 = "Single network with Spearman, treated",
showTitle = T,
cexTitle = 2.3,
nodeColor = colVector)
plot(props_single_fullSet,
labelScale = F,
cexLabels = 1.3,
title1 = "Single network with Spearman "+chosenWeek,
showTitle = T,
cexTitle = 2.3,
nodeColor = colVector)
?title1
??title1
?title
plot(props_single_fullSet,
labelScale = F,
cexLabels = 1.3,
title1 = paste("Single network with Spearman ",chosenWeek),
showTitle = T,
cexTitle = 2.3,
nodeColor = colVector)
