showTitle = T,
cexTitle = 2.3)
plot(props_single_fullSet,
labelScale = F,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", chosenWeek, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
rm(list=ls())
# loading functions
source("Programming/extracting_data_NATH.R")
source("Programming/data_filtering.R")
# loading data
chosenDataSet = "metab"         # "metab" or "genom"
chosenTaxonomy  <- "species"    # "species" or "genus"
chosenWeek      <- "4"          # "1", "4", or "10"
inData <- extracting_data_NATH(whichWeek=chosenWeek, whichTaxLevel=chosenTaxonomy)
# filtering data
inData <- data_filtering(data=inData, whichDataSet=chosenDataSet, whichWeek=chosenWeek)
data = inData
dataOneColumns <- grep(x = colnames(data), pattern = "DATA.*")
colVector <- 1:length(colnames(data))
for (i in 1:length(colVector)) {
if (i<=max(dataOneColumns)) {colVector[i] = "green"} else {colVector[i] = "red"}
}
if (chosenTaxonomy=="genus"){
colnames(data)=gsub("DATA.Bacteria_[A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.](.*)","\\1",colnames(data))
colnames(data)=gsub("DATA.Archaea_[A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.](.*)","\\1",colnames(data))
} else {
colnames(data)=gsub("DATA.Bacteria_[A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.](.*)[_.](.*)","\\1",colnames(data))
colnames(data)=gsub("DATA.Archaea_[A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.](.*)[_.](.*)","\\1",colnames(data))
}
# building single network with spearman as association measure - Full dataset, both treated and untreated
net_single_fullSet <- netConstruct((data),
#filtTax = "highestFreq",
#filtTaxPar = list(highestFreq = 100),
#filtSamp = "totalReads",
#filtSampPar = list(totalReads = 1000),
measure = "spearman",thresh = 0.5,
measurePar = list(nlambda=10,
rep.num=10),
normMethod = "none",
zeroMethod = "none",
sparsMethod = "threshold",
dissFunc = "signed",
verbose = 3,weighted = T,
seed = 123456)
View(net_single_fullSet)
?netAnalyze
props_single_fullSet <- netAnalyze(net_single_fullSet,
centrLCC = TRUE,
clustMethod = "cluster_fast_greedy",
hubPar = "eigenvector",
weightDeg = FALSE, normDeg = FALSE)
#?summary.microNetProps
summary(props_single_fullSet, numbNodes = 5L)
plot(props_single_fullSet,
labelScale = F,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", chosenWeek, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
# building single network with spearman as association measure - Full dataset, both treated and untreated
net_single_fullSet <- netConstruct((data),
#filtTax = "highestFreq",
#filtTaxPar = list(highestFreq = 100),
#filtSamp = "totalReads",
#filtSampPar = list(totalReads = 1000),
measure = "spearman",thresh = 0.7,
measurePar = list(nlambda=10,
rep.num=10),
normMethod = "none",
zeroMethod = "none",
sparsMethod = "threshold",
dissFunc = "signed",
verbose = 3,weighted = T,
seed = 123456)
props_single_fullSet <- netAnalyze(net_single_fullSet,
centrLCC = TRUE,
clustMethod = "cluster_fast_greedy",
hubPar = "eigenvector",
weightDeg = FALSE, normDeg = FALSE)
#?summary.microNetProps
summary(props_single_fullSet, numbNodes = 5L)
plot(props_single_fullSet,
labelScale = F,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", chosenWeek, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
# building single network with spearman as association measure - Full dataset, both treated and untreated
net_single_fullSet <- netConstruct((data),
#filtTax = "highestFreq",
#filtTaxPar = list(highestFreq = 100),
#filtSamp = "totalReads",
#filtSampPar = list(totalReads = 1000),
measure = "spearman",thresh = 0.9,
measurePar = list(nlambda=10,
rep.num=10),
normMethod = "none",
zeroMethod = "none",
sparsMethod = "threshold",
dissFunc = "signed",
verbose = 3,weighted = T,
seed = 123456)
props_single_fullSet <- netAnalyze(net_single_fullSet,
centrLCC = TRUE,
clustMethod = "cluster_fast_greedy",
hubPar = "eigenvector",
weightDeg = FALSE, normDeg = FALSE)
#?summary.microNetProps
summary(props_single_fullSet, numbNodes = 5L)
plot(props_single_fullSet,
labelScale = F,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", chosenWeek, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
# building single network with spearman as association measure - Full dataset, both treated and untreated
net_single_fullSet <- netConstruct((data),
#filtTax = "highestFreq",
#filtTaxPar = list(highestFreq = 100),
#filtSamp = "totalReads",
#filtSampPar = list(totalReads = 1000),
measure = "spearman",thresh = 0.8,
measurePar = list(nlambda=10,
rep.num=10),
normMethod = "none",
zeroMethod = "none",
sparsMethod = "threshold",
dissFunc = "signed",
verbose = 3,weighted = T,
seed = 123456)
props_single_fullSet <- netAnalyze(net_single_fullSet,
centrLCC = TRUE,
clustMethod = "cluster_fast_greedy",
hubPar = "eigenvector",
weightDeg = FALSE, normDeg = FALSE)
#?summary.microNetProps
summary(props_single_fullSet, numbNodes = 5L)
plot(props_single_fullSet,
labelScale = F,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", chosenWeek, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
chosenWeek      <- "null"          # "1", "4", or "10"
inData <- extracting_data_NATH(whichWeek=chosenWeek, whichTaxLevel=chosenTaxonomy)
# filtering data
inData <- data_filtering(data=inData, whichDataSet=chosenDataSet, whichWeek=chosenWeek)
# loading data
chosenDataSet = "metab"         # "metab" or "genom"
chosenTaxonomy  <- "species"    # "species" or "genus"
chosenWeek      <- "null"       # "1", "4", or "10"
inData <- extracting_data_NATH(whichWeek=chosenWeek, whichTaxLevel=chosenTaxonomy)
# filtering data
inData <- data_filtering(data=inData, whichDataSet=chosenDataSet, whichWeek=chosenWeek)
# can only select week number 1, 4, or 10
choiceOfWeekHere <- "1"
if (choiceOfWeekHere != "null") {
data = inData[gsub(".+-(?=\\d+$)", "", rownames(inData), perl = TRUE)==choiceOfWeekHere,]
} else {
data = inData
}
dataOneColumns <- grep(x = colnames(data), pattern = "DATA.*")
colVector <- 1:length(colnames(data))
for (i in 1:length(colVector)) {
if (i<=max(dataOneColumns)) {colVector[i] = "green"} else {colVector[i] = "red"}
}
if (chosenTaxonomy=="genus"){
colnames(data)=gsub("DATA.Bacteria_[A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.](.*)","\\1",colnames(data))
colnames(data)=gsub("DATA.Archaea_[A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.](.*)","\\1",colnames(data))
} else {
colnames(data)=gsub("DATA.Bacteria_[A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.](.*)[_.](.*)","\\1",colnames(data))
colnames(data)=gsub("DATA.Archaea_[A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.][A-Za-z]*[_.](.*)[_.](.*)","\\1",colnames(data))
}
# building single network with spearman as association measure - Full dataset, both treated and untreated
net_single_fullSet <- netConstruct((data),
#filtTax = "highestFreq",
#filtTaxPar = list(highestFreq = 100),
#filtSamp = "totalReads",
#filtSampPar = list(totalReads = 1000),
measure = "spearman",thresh = 0.8,
measurePar = list(nlambda=10,
rep.num=10),
normMethod = "none",
zeroMethod = "none",
sparsMethod = "threshold",
dissFunc = "signed",
verbose = 3,weighted = T,
seed = 123456)
props_single_fullSet <- netAnalyze(net_single_fullSet,
centrLCC = TRUE,
clustMethod = "cluster_fast_greedy",
hubPar = "eigenvector",
weightDeg = FALSE, normDeg = FALSE)
#?summary.microNetProps
summary(props_single_fullSet, numbNodes = 5L)
plot(props_single_fullSet,
labelScale = F,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", chosenWeek, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
# building single network with spearman as association measure - Full dataset, both treated and untreated
net_single_fullSet <- netConstruct((data),
#filtTax = "highestFreq",
#filtTaxPar = list(highestFreq = 100),
#filtSamp = "totalReads",
#filtSampPar = list(totalReads = 1000),
measure = "spearman",thresh = 0.6,
measurePar = list(nlambda=10,
rep.num=10),
normMethod = "none",
zeroMethod = "none",
sparsMethod = "threshold",
dissFunc = "signed",
verbose = 3,weighted = T,
seed = 123456)
props_single_fullSet <- netAnalyze(net_single_fullSet,
centrLCC = TRUE,
clustMethod = "cluster_fast_greedy",
hubPar = "eigenvector",
weightDeg = FALSE, normDeg = FALSE)
#?summary.microNetProps
summary(props_single_fullSet, numbNodes = 5L)
plot(props_single_fullSet,
labelScale = F,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", chosenWeek, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
?plot.microNetProps
plot(props_single_fullSet,
labelScale = T,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", chosenWeek, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = T,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", chosenWeek, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = T,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = T,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, ", taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = T,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere,,",", "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = T,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere,",", "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = T,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = F,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = F,
shortenLabels = "simple",
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = F,
shortenLabels = "intelligent",
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = F,
shortenLabels = "simple",
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = F,
shortenLabels = "none",
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
# building single network with spearman as association measure - Full dataset, both treated and untreated
net_single_fullSet <- netConstruct((data),
#filtTax = "highestFreq",
#filtTaxPar = list(highestFreq = 100),
#filtSamp = "totalReads",
#filtSampPar = list(totalReads = 1000),
measure = "spearman",thresh = 0.65,
measurePar = list(nlambda=10,
rep.num=10),
normMethod = "none",
zeroMethod = "none",
sparsMethod = "threshold",
dissFunc = "signed",
verbose = 3,weighted = T,
seed = 123456)
props_single_fullSet <- netAnalyze(net_single_fullSet,
centrLCC = TRUE,
clustMethod = "cluster_fast_greedy",
hubPar = "eigenvector",
weightDeg = FALSE, normDeg = FALSE)
#?summary.microNetProps
summary(props_single_fullSet, numbNodes = 5L)
plot(props_single_fullSet,
labelScale = F,
shortenLabels = "none",
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = F,
shortenLabels = "none",
nodeFilter = "highestconnect",
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = F,
shortenLabels = "none",
nodeFilter = "highestConnect",
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = F,
shortenLabels = "none",
nodeFilter = "highestDegree",
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = F,
shortenLabels = "none",
nodeFilter = "clustMin",
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = F,
shortenLabels = "none",
nodeFilter = "clustMin",
nodeFilterPar = 2,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = F,
shortenLabels = "none",
nodeFilter = "clustMin",
nodeFilterPar = 10,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = F,
shortenLabels = "none",
nodeFilter = "clustMin",
nodeFilterPar = 20,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = F,
shortenLabels = "none",
nodeFilter = "clustMin",
nodeFilterPar = 3,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = F,
shortenLabels = "none",
#nodeFilter = "clustMin",
nodeFilter = "highestConnect",
nodeFilterPar = 10,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = F,
shortenLabels = "none",
#nodeFilter = "clustMin",
nodeFilter = "highestConnect",
nodeFilterPar = 2,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = F,
shortenLabels = "none",
#nodeFilter = "clustMin",
nodeFilter = "highestConnect",
nodeFilterPar = 100,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = F,
shortenLabels = "none",
#nodeFilter = "clustMin",
nodeFilter = "highestConnect",
nodeFilterPar = 50,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = F,
shortenLabels = "none",
#nodeFilter = "clustMin",
nodeFilter = "highestBetween",
nodeFilterPar = 50,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = F,
shortenLabels = "none",
nodeFilter = "clustMin",
#nodeFilter = "highestBetween",
#nodeFilterPar = 50,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
plot(props_single_fullSet,
labelScale = F,
shortenLabels = "none",
nodeFilter = "clustMin",
#nodeFilter = "highestBetween",
nodeFilterPar = 50,
cexLabels = 1.3,
title1 = paste("Single network with Spearman\nWeek:", choiceOfWeekHere, "taxonomy:", chosenTaxonomy),
#title1 = "Single network with Spearman",
showTitle = T,
cexTitle = 1.7)
inData_week1 <- data_filtering(data = extracting_data_NATH(whichWeek = "1"), whichDataSet = "metab", whichWeek = 1)
